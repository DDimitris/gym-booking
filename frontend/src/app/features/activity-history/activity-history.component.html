<div class="activity-history-container">
  <h1 *ngIf="!isInstructor">{{ "activity.title.member" | translate }}</h1>
  <h1 *ngIf="isInstructor">{{ "activity.title.instructor" | translate }}</h1>

  <div *ngIf="isLoading" class="loading">
    {{ "activity.loading" | translate }}
  </div>

  <div *ngIf="!isLoading">
    <!-- Instructor view: upcoming classes -->
    <section class="bookings-section" *ngIf="isInstructor">
      <h2>
        {{ "activity.upcoming.instructor.title" | translate }} ({{
          upcomingClasses.length
        }})
      </h2>
      <div *ngIf="upcomingClasses.length === 0" class="empty-state">
        {{ "activity.upcoming.instructor.empty" | translate }}
      </div>
      <div class="bookings-grid">
        <div *ngFor="let c of upcomingClasses" class="booking-card">
          <div class="booking-header">
            <h3>{{ c.name }}</h3>
            <span class="badge badge-primary">Scheduled</span>
          </div>
          <div class="booking-details">
            <div class="detail-row">
              <strong>{{ "activity.labels.type" | translate }}</strong>
              {{ getClassTypeName(c.classTypeId) }}
            </div>
            <div class="detail-row">
              <strong>{{ "activity.labels.start" | translate }}</strong>
              {{ c.startTime | date : "medium" }}
            </div>
            <div class="detail-row">
              <strong>{{ "activity.labels.end" | translate }}</strong>
              {{ c.endTime | date : "medium" }}
            </div>
            <div class="detail-row">
              <strong>{{ "activity.labels.location" | translate }}</strong>
              {{ c.location || ("activity.values.tbd" | translate) }}
            </div>
            <div class="detail-row">
              <strong>{{ "activity.labels.capacity" | translate }}</strong>
              {{ c.capacity }}
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Member view: upcoming bookings -->
    <section class="bookings-section" *ngIf="!isInstructor">
      <h2>
        {{ "activity.upcoming.member.title" | translate }} ({{
          upcomingBookings.length
        }})
      </h2>

      <div *ngIf="upcomingBookings.length === 0" class="empty-state">
        <span [innerHTML]="'activity.upcoming.member.empty' | translate"></span>
      </div>

      <div class="bookings-grid">
        <div *ngFor="let booking of upcomingBookings" class="booking-card">
          <div class="booking-header">
            <h3>{{ booking.gymClass?.name || "Unknown Class" }}</h3>
            <span class="badge" [ngClass]="getStatusBadgeClass(booking.status)">
              {{ getStatusLabel(booking.status) }}
            </span>
          </div>

          <div class="booking-details">
            <div class="detail-row">
              <strong>{{ "activity.labels.type" | translate }}</strong>
              {{ booking.classTypeName || ("activity.values.na" | translate) }}
            </div>
            <div class="detail-row">
              <strong>{{ "activity.labels.start" | translate }}</strong>
              {{ booking.gymClass?.startTime | date : "medium" }}
            </div>
            <div class="detail-row">
              <strong>{{ "activity.labels.end" | translate }}</strong>
              {{ booking.gymClass?.endTime | date : "medium" }}
            </div>
            <div class="detail-row">
              <strong>{{ "activity.labels.location" | translate }}</strong>
              {{
                booking.gymClass?.location ||
                  ("activity.values.tbd" | translate)
              }}
            </div>
            <div class="detail-row">
              <strong>{{ "activity.labels.booked" | translate }}</strong>
              {{ booking.bookedAt | date : "short" }}
            </div>
          </div>

          <div class="booking-actions">
            <button
              *ngIf="canCancel(booking)"
              class="btn-danger"
              (click)="cancelBooking(booking)"
            >
              {{ "activity.actions.cancelBooking" | translate }}
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Instructor view: past classes -->
    <section class="bookings-section" *ngIf="isInstructor">
      <h2>
        {{ "activity.past.instructor.title" | translate }} ({{
          pastClasses.length
        }})
      </h2>
      <div *ngIf="pastClasses.length === 0" class="empty-state">
        {{ "activity.past.instructor.empty" | translate }}
      </div>
      <div class="bookings-grid">
        <div *ngFor="let c of pastClasses" class="booking-card past">
          <div class="booking-header">
            <h3>{{ c.name }}</h3>
            <span class="badge badge-success">
              {{ "activity.status.completed" | translate }}
            </span>
          </div>
          <div class="booking-details">
            <div class="detail-row">
              <strong>{{ "activity.labels.type" | translate }}</strong>
              {{ getClassTypeName(c.classTypeId) }}
            </div>
            <div class="detail-row">
              <strong>{{ "activity.labels.date" | translate }}</strong>
              {{ c.startTime | date : "medium" }}
            </div>
            <div class="detail-row">
              <strong>{{ "activity.labels.location" | translate }}</strong>
              {{ c.location || ("activity.values.tbd" | translate) }}
            </div>
            <div class="detail-row">
              <strong>{{ "activity.labels.capacity" | translate }}</strong>
              {{ c.capacity }}
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Member view: past bookings -->
    <section class="bookings-section" *ngIf="!isInstructor">
      <h2>
        {{ "activity.past.member.title" | translate }} ({{
          pastBookings.length
        }})
      </h2>

      <div *ngIf="pastBookings.length === 0" class="empty-state">
        {{ "activity.past.member.empty" | translate }}
      </div>

      <div class="bookings-grid">
        <div *ngFor="let booking of pastBookings" class="booking-card past">
          <div class="booking-header">
            <h3>{{ booking.gymClass?.name || "Unknown Class" }}</h3>
            <span class="badge" [ngClass]="getStatusBadgeClass(booking.status)">
              {{ getStatusLabel(booking.status) }}
            </span>
          </div>

          <div class="booking-details">
            <div class="detail-row">
              <strong>{{ "activity.labels.type" | translate }}</strong>
              {{ booking.classTypeName || ("activity.values.na" | translate) }}
            </div>
            <div class="detail-row">
              <strong>{{ "activity.labels.date" | translate }}</strong>
              {{ booking.gymClass?.startTime | date : "medium" }}
            </div>
            <div class="detail-row">
              <strong>{{ "activity.labels.location" | translate }}</strong>
              {{
                booking.gymClass?.location ||
                  ("activity.values.tbd" | translate)
              }}
            </div>
            <div class="detail-row" *ngIf="booking.completedAt">
              <strong>{{ "activity.labels.completed" | translate }}</strong>
              {{ booking.completedAt | date : "short" }}
            </div>
            <div class="detail-row" *ngIf="booking.cancelledAt">
              <strong>{{ "activity.labels.cancelled" | translate }}</strong>
              {{ booking.cancelledAt | date : "short" }}
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>
